@model _24DH110457_MyStore.Models.Order

@{
    ViewBag.Title = "Xác nhận đơn hàng";
    Layout = "~/Views/Shared/_Layout.cshtml";
}

<div class="container mt-5">
    <div class="alert alert-success text-center" role="alert">
        <i class="fas fa-check-circle fa-2x mb-2"></i>
        <h3>ĐẶT HÀNG THÀNH CÔNG!</h3>
        <p>Cảm ơn quý khách đã tin tưởng. Mã đơn hàng của quý khách là: <strong>#@Model.OrderID</strong></p>
    </div>

    <h4 class="mt-4 mb-3">Thông tin đơn hàng</h4>
    <div class="card p-3">
        <p><strong>Mã đơn hàng:</strong> #@Model.OrderID</p>
        <p><strong>Ngày đặt hàng:</strong> @Model.OrderDate.ToString("dd/MM/yyyy HH:mm")</p>
        <p><strong>Địa chỉ giao hàng:</strong> @Model.ShippingAddress</p>
        <p><strong>Phương thức thanh toán:</strong> @Model.PaymentMethod</p>

        @* FIX: REMOVE .HasValue and .Value on TotalAmount *@
        <p>
            <strong>Tổng cộng:</strong>
            <span class="text-danger fw-bold">
                @Model.TotalAmount.ToString("N0") ₫
            </span>
        </p>
        <p><strong>Trạng thái:</strong> @Model.PaymentStatus</p>
    </div>

    <h4 class="mt-4 mb-3">Chi tiết sản phẩm</h4>
    <table class="table table-bordered">
        <thead class="table-light">
            <tr>
                <th>Sản phẩm</th>
                <th>Số lượng</th>
                <th>Đơn giá</th>
                <th>Tổng giá</th>
            </tr>
        </thead>
        <tbody>
            @foreach (var item in Model.OrderDetails)
            {
                <tr>
                    <td>@item.Product.ProductName</td>
                    <td>@item.Quantity</td>

                    @* FIX: UnitPrice (Bỏ logic sửa lỗi đã gây lỗi mới) *@
                    <td>@item.UnitPrice.ToString("N0") ₫</td>

                    @* FIX: TotalPrice (Bỏ logic sửa lỗi đã gây lỗi mới) *@
                <td>@Html.DisplayFor(modelItem => item.UnitPrice) ₫</td>
                </tr>
            }
        </tbody>
       
    </table>

    <div class="text-center mt-5">
        @Html.ActionLink("Tiếp tục mua hàng", "Index", "Home", null, new { @class = "btn btn-primary px-4" })
        @Html.ActionLink("Xem lịch sử đơn hàng", "OrderHistory", "Order", null, new { @class = "btn btn-outline-info ms-3 px-4" })
    </div>
</div>